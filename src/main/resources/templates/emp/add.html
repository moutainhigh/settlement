<!DOCTYPE html>
<html class="x-admin-sm" xmlns:th="http://www.thymeleaf.org">
    
    <head>
        <th:bolck th:include="common/header :: header('添加项目组员工')" />
        <link rel="stylesheet" th:href="@{/css/formSelects-v4.css}" />
    </head>
    <body>
       <div class="layui-fluid">
           <div class="layui-row">
                <form class="layui-form">
                    <div class="layui-form-item">

                        <!-- 必填内容 -->
                        <div class="layui-collapse" lay-accordion="">
                            <div class="layui-colla-item">
                                <h2 class="layui-colla-title">必填内容</h2>
                                <div class="layui-colla-content">
                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label for="empName" class="layui-form-label">
                                                <span class="x-red">*</span>员工姓名</label>
                                            <div class="layui-input-inline">
                                                <input type="text" id="empName" name="empName" required="" lay-verify="empName" autocomplete="off"  placeholder="请输入员工姓名" class="layui-input" maxlength="20">
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label for="code" class="layui-form-label">
                                                <span class="x-red">*</span>员工编号</label>
                                            <div class="layui-input-inline">
                                                <input type="text" id="code" name="code" required="" lay-verify="code" autocomplete="off"  placeholder="请输入员工编号" class="layui-input" maxlength="20">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label for="entranceTime" class="layui-form-label">
                                                <span class="x-red">*</span>入场时间</label>
                                            <div class="layui-input-inline layui-show-xs-block">
                                                <input  id="entranceTime" name="entranceTime" required="" lay-verify="entranceTime" autocomplete="off"  placeholder="请输入入场时间" class="layui-input" >
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label for="place" class="layui-form-label">
                                                <span class="x-red">*</span>员工所在地</label>
                                            <div class="layui-input-inline">
                                                <input type="text" id="place" name="place" required="" lay-verify="place" autocomplete="off"  placeholder="请输入员工所在地" class="layui-input" maxlength="50">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label for="responsiblePerson" class="layui-form-label">
                                                <span class="x-red">*</span>客户负责人</label>
                                            <div class="layui-input-inline layui-show-xs-block">
                                                <input  id="responsiblePerson" name="responsiblePerson" required="" lay-verify="responsiblePerson" autocomplete="off"  placeholder="请输入客户负责人" class="layui-input" maxlength="20">
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label for="rpEmail" class="layui-form-label">
                                                <span class="x-red">*</span>邮件地址</label>
                                            <div class="layui-input-inline">
                                                <input type="text" id="rpEmail" name="rpEmail" required="" lay-verify="email" autocomplete="off"  placeholder="请输入客户负责人邮件地址" class="layui-input" maxlength="100">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label class="layui-form-label">
                                                <span class="x-red">*</span>结算抄送邮件</label>
                                            <div class="layui-input-inline layui-show-xs-block">
                                                <input type="text" id="sendCopyEmail" name="sendCopyEmail" required="" lay-verify="email" autocomplete="off"  placeholder="请输入结算发送抄送人邮件地址(客户方)" class="layui-input" maxlength="400">
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label class="layui-form-label">
                                                <span class="x-red">*</span>级别</label>
                                            <div class="layui-input-inline">
                                                <select name="posLevel" lay-filter="posLevel">
                                                    <option value="" selected>请选择</option>
                                                    <option value="0">写作</option>
                                                    <option value="1">阅读</option>
                                                    <option value="2">游戏</option>
                                                    <option value="3">音乐</option>
                                                    <option value="4">旅行</option>
                                                </select>
                                            </div>
                                            <button type="button" onclick="setPass()" class="layui-btn layui-btn-primary layui-btn-xs">手填</button>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label class="layui-form-label"><span class="x-red">*</span>服务费(月)</label>
                                            <div class="layui-input-inline">
                                                <input name="priceMonth" readonly="readonly" id="priceMonth" class="layui-input" required="" lay-verify="priceMonth" autocomplete="off"  placeholder=""  maxlength="10">
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label class="layui-form-label">
                                                <span class="x-red">*</span>单位</label>
                                            <div class="layui-input-inline">
                                                <select name="unit" lay-filter="unit">
                                                    <option value="" selected>请选择</option>
                                                    <option value="0">元</option>
                                                    <option value="1">万元</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- 上传图片-->
                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label class="layui-form-label"><span class="x-red">*</span>客户确认邮件</label>
                                            <div class="layui-inline layui-upload">
                                                <button class="layui-btn" id="test1" type="button">上传客户确认rate邮件图片</button>
                                            </div>
                                        </div>
                                        <div class="layui-inline layui-upload-list">
                                            <img class="layui-upload-img" id="demo1" width="600" height="200">
                                            <p id="demoText"></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ///////////////////////////////////////////////  以下是选填内容 ////////////////////////////////////////////////////////// -->

                        <div class="layui-collapse" lay-accordion="">
                            <div class="layui-colla-item">
                                <h2 class="layui-colla-title">选填内容</h2>
                                <div class="layui-colla-content">
                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label class="layui-form-label">服务费(天)</label>
                                            <div class="layui-input-inline">
                                                <input name="priceDay" readonly="readonly" id="priceDay" class="layui-input" required="" lay-verify="priceDay" autocomplete="off"  placeholder=""  maxlength="10">
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label class="layui-form-label">岗位</label>
                                            <div class="layui-inline">
                                                <input name="position" id="position" class="layui-input"  lay-verify="position" autocomplete="off"  placeholder=""  maxlength="20">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label class="layui-form-label">证件号码</label>
                                            <div class="layui-input-inline">
                                                <input name="cardNo" id="cardNo" class="layui-input"  lay-verify="cardNo" autocomplete="off"  placeholder=""  maxlength="20">
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label class="layui-form-label">报销接口人</label>
                                            <div class="layui-input-inline">
                                                <input name="claimExpensePerson" id="claimExpensePerson" class="layui-input" lay-verify="claimExpensePerson" autocomplete="off"  placeholder=""  maxlength="10">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label class="layui-form-label">考勤负责人</label>
                                            <div class="layui-input-inline">
                                                <input name="workAttendencePerson" id="workAttendencePerson" class="layui-input"  lay-verify="workAttendencePerson" autocomplete="off"  placeholder=""  maxlength="20">
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label class="layui-form-label">员工月薪</label>
                                            <div class="layui-input-inline">
                                                <input name="salaryMonth" id="salaryMonth" class="layui-input" lay-verify="salaryMonth" autocomplete="off"  placeholder=""  maxlength="10">
                                            </div>
                                        </div>
                                    </div>

                                    <div class="layui-form-item">
                                        <div class="layui-inline">
                                            <label class="layui-form-label">员工日薪</label>
                                            <div class="layui-input-inline">
                                                <input name="salaryDay" id="salaryDay" class="layui-input"  lay-verify="salaryDay" autocomplete="off"  placeholder=""  maxlength="20">
                                            </div>
                                        </div>
                                        <div class="layui-inline">
                                            <label class="layui-form-label"></label>
                                            <div class="layui-input-inline">
                                                <!--<input name="" id="" class="layui-input" lay-verify="" autocomplete="off"  placeholder=""  maxlength="10">-->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>





                        <div class="layui-form-item">
                            <label for="saveButton" class="layui-form-label"></label>
                            <button class="layui-btn" id="saveButton" lay-filter="saveButton" lay-submit="">增加</button>
                            <button class="layui-btn layui-btn-normal" id="submitButton" lay-filter="submitButton" lay-submit="">增加并提交</button>
                        </div>
                   </div>
                </form>
           </div>
        </div>
       <!-- <script th:src="@{/js/formSelects-v4.js}" type="text/javascript" charset="utf-8"></script>-->
       <!-- <script th:src="@{/js/pg/pg.js}" type="text/javascript" charset="utf-8"></script>-->
        <script type="text/javascript">
            // 表单操作
            layui.use(['laydate','form', 'layer','jquery','upload'],
            function() {
                $ = layui.jquery;
                var laydate = layui.laydate;
                var form = layui.form;
                var layer = layui.layer;
                var upload = layui.upload;

                //普通图片上传
                var uploadInst = upload.render({
                    elem: '#test1'
                    ,url: '/upload/'
                    ,before: function(obj){
                        //预读本地文件示例，不支持ie8
                       obj.preview(function(index, file, result){
                            $('#demo1').attr('src', result); //图片链接（base64）
                        });
                    }
                    ,done: function(res){
                        //如果上传失败
                        if(res.code > 0){
                            return layer.msg('上传失败');
                        }
                        //上传成功
                    }
                    ,error: function(){
                        //演示失败状态，并实现重传
                       /* var demoText = $('#demoText');
                        demoText.html('<span style="color: #FF5722;">上传失败</span> <a class="layui-btn layui-btn-xs demo-reload">重试</a>');
                        demoText.find('.demo-reload').on('click', function(){
                            uploadInst.upload();
                        });*/
                    }
                });


                laydate.render({
                   elem: '#entranceTime'
                });

                form.render();
                //自定义验证规则
                form.verify({
                    pgName: function(value) {
                        if (value.trim().length < 1) {
                            return '项目组至少得1个字符啊';
                        }
                    },
                    code: function (value) {
                        if (value.trim().length < 1) {
                            return '编号至少得1个字符啊';
                        }
                    },
                    checkUserId: function(value) {
                        if (value.length < 1) {
                            return '客户经理至少得选择一个啊';
                        }
                    }
                });

                //监听保存
                form.on('submit(saveButton)',
                    function(data) {
                        if (checkPgIsExist($("#code").val(),layer,'submit')) {
                            $.post('/ba-project-group/add',data.field, function(r) {
                                layer.alert(r.msg, {
                                        icon : r.code == 'add_200' ? 6: 5
                                    },
                                    function() {
                                        //关闭当前frame
                                        xadmin.close();
                                        // 可以对父窗口进行刷新
                                        xadmin.father_reload();
                                    });
                            });
                        }
                        return false;
                    });

                //监听提交
                form.on('submit(submitButton)',
                function(data) {
                    layer.confirm('确认提交么?提交后需要审核，项目组、项目组编号将不能编辑', function(index) {
                        if (checkPgIsExist($("#code").val(), layer, 'submit')) {
                            $.post('/ba-project-group/addsubmit', data.field, function (r) {
                                layer.alert(r.msg, {
                                        icon: r.code == 'add_200' ? 6 : 5
                                    },
                                    function () {
                                        //关闭当前frame
                                        xadmin.close();
                                        // 可以对父窗口进行刷新
                                        xadmin.father_reload();
                                    });
                            });
                        }
                    });
                    return false;
                });

                // 监听检查项目组是否存在
                $(document).on('click','#pgIsExist', function(data) {
                    var code = $("#code").val();
                    if (code.trim() != '') {
                        checkPgIsExist(code.trim(), layer,'');
                    }
                });
            });
        </script>
    </body>
</html>